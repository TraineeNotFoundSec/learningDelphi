unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, FireDAC.Stan.Intf,
  FireDAC.Stan.Option, FireDAC.Stan.Error, FireDAC.UI.Intf, FireDAC.Phys.Intf,
  FireDAC.Stan.Def, FireDAC.Stan.Pool, FireDAC.Stan.Async, FireDAC.Phys,
  FireDAC.Phys.PG, FireDAC.Phys.PGDef, FireDAC.VCLUI.Wait, FireDAC.Stan.Param,
  FireDAC.DatS, FireDAC.DApt.Intf, FireDAC.DApt, Data.DB, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client;

type
  TForm1 = class(TForm)
    Label1: TLabel;
    Edit1: TEdit;
    Edit2: TEdit;
    Label2: TLabel;
    Label3: TLabel;
    Button1: TButton;
    Label4: TLabel;
    Label5: TLabel;
    FDConnection1: TFDConnection;
    FDQuery1: TFDQuery;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var
  usuario: string;
  senha: string;
  query: string;
  encontrado: Boolean;
begin
  usuario := Edit1.Text;
  senha := Edit2.Text;

  // Verifica se os campos estão preenchidos
  if (usuario = '') or (senha = '') then
  begin
    ShowMessage('Por favor, preencha usuário e senha.');
    //Exit;
  end;

  // Configura a consulta SQL
  //query := 'SELECT id_user FROM users WHERE user = :usuario AND password = :senha';
  query := 'SELECT COUNT(*) FROM users WHERE user = ''' + usuario + ''' AND password = ''' + senha + '''';

  ShowMessage(query);
  try
    FDConnection1.Connected := True; // Conecta ao banco de dados

    FDQuery1.SQL.Text := query;
    //FDQuery1.ParamByName('usuario').AsString := usuario;
    //FDQuery1.ParamByName('senha').AsString := senha;

    FDQuery1.Open;

    // Verifica se encontrou o usuário e senha
    encontrado := FDQuery1.Fields[0].AsInteger > 0;

    if encontrado then
      ShowMessage('Usuário e senha válidos!')
    else
      ShowMessage('Usuário ou senha inválidos.');

  except
    on E: Exception do
      ShowMessage('Erro ao acessar o banco de dados: ' + E.Message);
  end;

  FDConnection1.Connected := False; // Desconecta do banco de dados
end;

end.

